diff -ur snapshot-20001121.orig/src/global/mynetworks.c snapshot-20001121/src/global/mynetworks.c
--- snapshot-20001121.orig/src/global/mynetworks.c	Fri Dec 11 19:55:22 1998
+++ snapshot-20001121/src/global/mynetworks.c	Wed Nov 29 00:32:10 2000
@@ -2,17 +2,16 @@
 /* NAME
 /*	mynetworks 3
 /* SUMMARY
-/*	generate patterns for my own interface addresses
+/*	generate default mynetworks setting
 /* SYNOPSIS
 /*	#include <mynetworks.h>
 /*
 /*	const char *mynetworks()
 /* DESCRIPTION
 /*	This routine uses the address list built by own_inet_addr()
-/*	to produce a list of patterns that match the corresponding
-/*	networks. The patterns are conservative: they match whole
-/*	class A, B, C or D networks. This is usually sufficient to
-/*	distinguish between organizations.
+/*	to produce a list for mynetworks which includes all local
+/*	interfaces with a netmask of /32 because we don't want to
+/*	allow other hosts to relay by default.
 /* LICENSE
 /* .ad
 /* .fi
@@ -59,9 +58,7 @@
 	char   *myname = "mynetworks";
 	INET_ADDR_LIST *my_addr_list;
 	unsigned long addr;
-	unsigned long mask;
 	struct in_addr net;
-	int     shift;
 	int     i;
 
 	result = vstring_alloc(20);
@@ -69,25 +66,14 @@
 
 	for (i = 0; i < my_addr_list->used; i++) {
 	    addr = ntohl(my_addr_list->addrs[i].s_addr);
-	    if (IN_CLASSA(addr)) {
-		mask = IN_CLASSA_NET;
-		shift = IN_CLASSA_NSHIFT;
-	    } else if (IN_CLASSB(addr)) {
-		mask = IN_CLASSB_NET;
-		shift = IN_CLASSB_NSHIFT;
-	    } else if (IN_CLASSC(addr)) {
-		mask = IN_CLASSC_NET;
-		shift = IN_CLASSC_NSHIFT;
-	    } else if (IN_CLASSD(addr)) {
-		mask = IN_CLASSD_NET;
-		shift = IN_CLASSD_NSHIFT;
-	    } else {
-		msg_fatal("%s: bad address class: %s",
-			  myname, inet_ntoa(my_addr_list->addrs[i]));
+	    if (!IN_CLASSA(addr) && !IN_CLASSB(addr) &&
+					!IN_CLASSC(addr) && !IN_CLASSD(addr)) {
+			msg_fatal("%s: bad address class: %s",
+				myname, inet_ntoa(my_addr_list->addrs[i]));
 	    }
-	    net.s_addr = htonl(addr & mask);
+	    net.s_addr = htonl(addr);
 	    vstring_sprintf_append(result, "%s/%d ",
-				   inet_ntoa(net), BITS_PER_ADDR - shift);
+				  inet_ntoa(net), BITS_PER_ADDR);
 	}
 	if (msg_verbose)
 	    msg_info("%s: %s", myname, vstring_str(result));
Only in snapshot-20001121/src/global: mynetworks.c.localnet8
diff -ur snapshot-20001121.orig/src/global/mynetworks.h snapshot-20001121/src/global/mynetworks.h
--- snapshot-20001121.orig/src/global/mynetworks.h	Fri Dec 11 19:55:26 1998
+++ snapshot-20001121/src/global/mynetworks.h	Tue Nov 28 22:44:33 2000
@@ -5,7 +5,7 @@
 /* NAME
 /*	mynetworks 3h
 /* SUMMARY
-/*	lookup patterns for my own interface addresses
+/*	generate default mynetworks setting
 /* SYNOPSIS
 /*	#include <mynetworks.h>
 /* DESCRIPTION
