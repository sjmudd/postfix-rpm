#!/bin/sh
#
#  $Id: make-postfix.spec,v 1.1 2000/12/22 15:00:00 root Exp $

POSTFIX_NAME=postfix
POSTFIX_CCARGS=
POSTFIX_AUXLIBS=

# supposedly redhat now include LDAP libraries in the default install, so
# include LDAP support by default
#if [ "$POSTFIX_LDAP" = "1" ]; then
if [ "1" = "1" ]; then
  { POSTFIX_CCARGS+=' -I/usr/local/include -DHAS_LDAP'; POSTFIX_AUXLIBS+=' -L/usr/lib -lldap -llber'; POSTFIX_NAME+='+ldap' }
fi
if [ "$POSTFIX_PCRE" = "1" ]; then
  { POSTFIX_CCARGS+=' -DHAS_PCRE'; POSTFIX_AUXLIBS+=' -lpcre'; POSTFIX_NAME+='+pcre' }
fi
if [ "$POSTFIX_MYSQL" = "1" ]; then
  { POSTFIX_CCARGS+=; POSTFIX_AUXLIBS+=; POSTFIX_NAME+='+mysql' }
fi
if [ "$POSTFIX_SASL" = "1" ]; then
  { POSTFIX_CCARGS+=' -DUSE_SASL_AUTH'; POSTFIX_AUXLIBS+=' -lsasl'; POSTFIX_NAME+='+sasl' }
fi

( echo <<EOF
###########################################################
#
# W A R N I N G -- DO NOT EDIT THIS FILE -- W A R N I N G
#
# It is generated automatically from postfix.spec.in
# in the SOURCES directory.
#
# If you need to make changes do them to the postfix.spec.in
# file and regenerate the spec file with
#
#     cd ../SOURCES
#     postfix-Make-specfile
#
# after defining the relevent options you wish to use in
# the spec file
#
# This spec file genreated with the following options:
#
# POSTFIX_SMTPD_MULTILINE_GREETING=$POSTFIX_SMTPD_MULTILINE_GREETING
# POSTFIX_SAFE_MYNETWORKLS=$POSTFIX_SAFE_MYNETWORKS
# POSTFIX_LDAP=$POSTFIX_LDAP
# POSTFIX_PCRE=$POSTFIX_PCRE
# POSTFIX_MYSQL=$POSTFIX_MYSQL
# POSTFIX_SASL=$POSTFIX_SASL
#
###########################################################
EOF
sed < ./postfix.spec.in > ./SPECS/postfix.spec \
'
s/XX_POSTFIX_NAME_XX/$POSTFIX_NAME/g
s/XX_POSTFIX_CCARGS_XX/$POSTFIX_CCARGS/g
s/XX_POSTFIX_AUXLIBS_XX/$POSTFIX_AUXLIBS/g
'
